:root {
  --primary: #eb1000;
  --primary-dark: #c40d00;
  --bg: #f9fafb;
  --card-bg: #ffffff;
  --chart-bg: #f3f4f6;
  --text: #1d2939;
  --text-secondary: #667085;
  --border: #e4e7ec;
  --success: #12b76a;
  --error: #f04438;
  --chart-line: #eb1000;
  --bar-bg: #fce4e4;
  --status-ok: #12b76a;
  --status-client-error: #f79009;
  --status-server-error: #f04438;
  --input-bg: #ffffff;
  --filter-tag-bg: #e8f4fd;
  --filter-tag-border: #b8daff;
  --filter-tag-color: #004085;
  --grid-line: #d1d5db;
  --axis-line: #e4e7ec;
  --host-delivery: #2563eb;
  --host-authoring: #7c3aed;
  --host-customer: #ea580c;
  --ct-text: #059669;
  --ct-application: #7c3aed;
  --ct-image: #0891b2;
  --ct-video: #dc2626;
  --ct-font: #ca8a04;
  --ct-binary: #64748b;
  --cache-hit: #059669;
  --cache-miss: #dc2626;
  --cache-pass: #ca8a04;
  --cache-dynamic: #7c3aed;
  --cache-revalidated: #0891b2;
  --cache-expired: #ea580c;
  --cache-stale: #d97706;
  --cache-error: #be123c;
  --cache-unknown: #64748b;
  --path-directory: #7c3aed;
  --path-clean: #2563eb;
  --path-script: #ca8a04;
  --path-document: #059669;
  --path-image: #0891b2;
  --path-media: #dc2626;
  --path-font: #9333ea;
  --path-server: #be123c;
  --ref-google: #34a853;
  --ref-adobe: #fa0f00;
  --ref-aem: #2563eb;
  --ref-other: #64748b;
  --ua-windows: #0078d4;
  --ua-mac: #555555;
  --ua-linux: #e95420;
  --ua-ios: #147ce5;
  --ua-android: #3ddc84;
  --ua-good-bot: #059669;
  --ua-bad-bot: #dc2626;
  --ip-v4: #2563eb;
  --ip-v6: #7c3aed;
  --ip-v4-multi: #0891b2;
  --ip-v6-multi: #a855f7;
  --ip-bad: #dc2626;
  /* Request Types - Delivery category (blue, matches --host-delivery for .live) */
  --rt-pipeline: #2563eb;
  --rt-static: #3b82f6;
  --rt-media: #0ea5e9;
  --rt-rum: #06b6d4;
  /* Request Types - Pipeline service category (violet, matches --host-authoring for .page) */
  --rt-html: #7c3aed;
  --rt-json: #8b5cf6;
  --rt-md: #a855f7;
  --rt-robots: #c084fc;
  /* Request Types - Static service category (teal) */
  --rt-content: #14b8a6;
  --rt-code: #0d9488;
  /* Request Types - Admin service category (orange/amber, 8 types need good range) */
  --rt-job: #ea580c;
  --rt-discover: #f97316;
  --rt-preview: #fb923c;
  --rt-status: #f59e0b;
  --rt-sidekick: #d97706;
  --rt-github-bot: #b45309;
  --rt-live: #92400e;
  --rt-auth: #78350f;
  /* Request Types - Config service category (green) */
  --rt-admin: #059669;
  --rt-delivery: #10b981;
  --rt-config: #64748b;
  --bt-aws: #22a858;
  --bt-cloudflare: #f38020;
  --method-get: #2563eb;
  --method-post: #059669;
  --method-put: #ca8a04;
  --method-patch: #7c3aed;
  --method-head: #64748b;
  --method-options: #64748b;
  --asn-adobe: #fa0f00;
  --asn-good-cdn: #059669;
  --asn-bad-cdn: #dc2626;
  --asn-cloud: #7c3aed;
  --asn-other: #64748b;
  --err-redirect: #2563eb;
  --err-security: #dc2626;
  --err-contentbus: #ca8a04;
  --err-storage: #64748b;
  --err-other: #94a3b8;
  /* Accept-Encoding */
  --enc-gzip: #059669;
  --enc-br: #2563eb;
  --enc-deflate: #ca8a04;
  --enc-identity: #64748b;
  --enc-zstd: #7c3aed;
  /* Cache-Control (request) */
  --cc-no-cache: #dc2626;
  --cc-no-store: #be123c;
  --cc-max-age: #059669;
  --cc-other: #64748b;
  /* BYO CDN */
  --cdn-fastly: #ff282d;
  --cdn-akamai: #0096d6;
  --cdn-cloudfront: #ff9900;
  --cdn-other: #64748b;
  /* Redirect Location */
  --loc-relative: #059669;
  --loc-absolute: #2563eb;
}

@media (prefers-color-scheme: dark) {
  :root {
    --primary: #ff4136;
    --primary-dark: #ff6b63;
    --bg: #0d1117;
    --card-bg: #161b22;
    --chart-bg: #0a0e13;
    --text: #e6edf3;
    --text-secondary: #8b949e;
    --border: #30363d;
    --success: #3fb950;
    --error: #f85149;
    --chart-line: #ff4136;
    --bar-bg: #3d1a1a;
    --status-ok: #3fb950;
    --status-client-error: #d29922;
    --status-server-error: #f85149;
    --input-bg: #0d1117;
    --filter-tag-bg: #1f3a5f;
    --filter-tag-border: #388bfd;
    --filter-tag-color: #79c0ff;
    --grid-line: #21262d;
    --axis-line: #30363d;
    --host-delivery: #60a5fa;
    --host-authoring: #a78bfa;
    --host-customer: #fb923c;
    --ct-text: #34d399;
    --ct-application: #a78bfa;
    --ct-image: #22d3ee;
    --ct-video: #f87171;
    --ct-font: #facc15;
    --ct-binary: #94a3b8;
    --cache-hit: #34d399;
    --cache-miss: #f87171;
    --cache-pass: #facc15;
    --cache-dynamic: #a78bfa;
    --cache-revalidated: #22d3ee;
    --cache-expired: #fb923c;
    --cache-stale: #fbbf24;
    --cache-error: #fb7185;
    --cache-unknown: #94a3b8;
    --path-directory: #a78bfa;
    --path-clean: #60a5fa;
    --path-script: #facc15;
    --path-document: #34d399;
    --path-image: #22d3ee;
    --path-media: #f87171;
    --path-font: #c084fc;
    --path-server: #fb7185;
    --ref-google: #81c995;
    --ref-adobe: #ff6b6b;
    --ref-aem: #60a5fa;
    --ref-other: #94a3b8;
    --ua-windows: #4cc2ff;
    --ua-mac: #a1a1a1;
    --ua-linux: #ff7847;
    --ua-ios: #5ac8fa;
    --ua-android: #7cfc9f;
    --ua-good-bot: #34d399;
    --ua-bad-bot: #f87171;
    --ip-v4: #60a5fa;
    --ip-v6: #a78bfa;
    --ip-v4-multi: #22d3ee;
    --ip-v6-multi: #c084fc;
    --ip-bad: #f87171;
    /* Request Types - Delivery category (blue) */
    --rt-pipeline: #60a5fa;
    --rt-static: #93c5fd;
    --rt-media: #38bdf8;
    --rt-rum: #22d3ee;
    /* Request Types - Pipeline service category (violet) */
    --rt-html: #a78bfa;
    --rt-json: #c4b5fd;
    --rt-md: #d8b4fe;
    --rt-robots: #e9d5ff;
    /* Request Types - Static service category (teal) */
    --rt-content: #2dd4bf;
    --rt-code: #5eead4;
    /* Request Types - Admin service category (orange/amber) */
    --rt-job: #fb923c;
    --rt-discover: #fdba74;
    --rt-preview: #fed7aa;
    --rt-status: #fcd34d;
    --rt-sidekick: #fbbf24;
    --rt-github-bot: #f59e0b;
    --rt-live: #d97706;
    --rt-auth: #b45309;
    /* Request Types - Config service category (green) */
    --rt-admin: #34d399;
    --rt-delivery: #6ee7b7;
    --rt-config: #94a3b8;
    --bt-aws: #4ade80;
    --bt-cloudflare: #f6a560;
    --method-get: #60a5fa;
    --method-post: #34d399;
    --method-put: #facc15;
    --method-patch: #a78bfa;
    --method-head: #94a3b8;
    --method-options: #94a3b8;
    --asn-adobe: #ff6b6b;
    --asn-good-cdn: #34d399;
    --asn-bad-cdn: #f87171;
    --asn-cloud: #a78bfa;
    --asn-other: #94a3b8;
    --err-redirect: #60a5fa;
    --err-security: #f87171;
    --err-contentbus: #facc15;
    --err-storage: #94a3b8;
    --err-other: #cbd5e1;
    /* Accept-Encoding */
    --enc-gzip: #34d399;
    --enc-br: #60a5fa;
    --enc-deflate: #facc15;
    --enc-identity: #94a3b8;
    --enc-zstd: #a78bfa;
    /* Cache-Control (request) */
    --cc-no-cache: #f87171;
    --cc-no-store: #fb7185;
    --cc-max-age: #34d399;
    --cc-other: #94a3b8;
    /* BYO CDN */
    --cdn-fastly: #ff6b6b;
    --cdn-akamai: #4cc2ff;
    --cdn-cloudfront: #ffb347;
    --cdn-other: #94a3b8;
    /* Redirect Location */
    --loc-relative: #34d399;
    --loc-absolute: #60a5fa;
  }
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

html {
  overflow: hidden;
  height: 100%;
}

body {
  font-family: 'Adobe Clean', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
  background: var(--bg);
  color: var(--text);
  line-height: 1.5;
  height: 100%;
  overflow-y: auto;
  overflow-x: hidden;
  overscroll-behavior-x: none;
  -webkit-overflow-scrolling: touch;
  scroll-snap-type: y proximity;
  scroll-padding-top: 70px;
}

/* Pull to refresh indicator */
.pull-to-refresh {
  height: 0;
  overflow: hidden;
  display: flex;
  align-items: center;
  justify-content: center;
  color: var(--text-secondary);
  font-size: 13px;
  background: var(--bg);
  transition: height 0.2s;
}

.pull-to-refresh.visible {
  height: 50px;
}

.pull-to-refresh.refreshing .pull-arrow {
  animation: spin 0.8s linear infinite;
}

.pull-arrow {
  margin-right: 8px;
  font-size: 16px;
}

/* Login Form */
#login {
  display: flex;
  align-items: center;
  justify-content: center;
  min-height: 100vh;
  padding: 20px;
}

#login.hidden { display: none; }

.login-card {
  background: var(--card-bg);
  border-radius: 12px;
  box-shadow: 0 4px 6px -1px rgba(0,0,0,0.1);
  padding: 40px;
  width: 100%;
  max-width: 400px;
}

.login-card h1 {
  font-size: 24px;
  margin-bottom: 8px;
}

.login-card p {
  color: var(--text-secondary);
  margin-bottom: 24px;
}

.form-group {
  margin-bottom: 16px;
}

.form-group label {
  display: block;
  font-size: 14px;
  font-weight: 500;
  margin-bottom: 6px;
}

.form-group input {
  width: 100%;
  padding: 10px 14px;
  border: 1px solid var(--border);
  border-radius: 8px;
  font-size: 14px;
  background: var(--input-bg);
  color: var(--text);
}

.form-group input:focus {
  outline: none;
  border-color: var(--primary);
  box-shadow: 0 0 0 3px rgba(235, 16, 0, 0.15);
}

.btn {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  padding: 10px 18px;
  border-radius: 8px;
  font-size: 14px;
  font-weight: 500;
  cursor: pointer;
  border: none;
  transition: background 0.2s;
}

.btn-primary {
  background: var(--primary);
  color: white;
  width: 100%;
}

.btn-primary:hover {
  background: var(--primary-dark);
}

.btn-secondary {
  background: var(--card-bg);
  color: var(--text);
  border: 1px solid var(--border);
}

.btn-secondary:hover {
  background: var(--bg);
}

.error-message {
  background: var(--bar-bg);
  border: 1px solid var(--error);
  color: var(--error);
  padding: 12px;
  border-radius: 8px;
  margin-bottom: 16px;
  font-size: 14px;
  display: none;
}

.error-message.visible { display: block; }

/* Dashboard */
#dashboard {
  display: none;
  min-height: 100vh;
}

#dashboard.visible { display: block; }

/* Header */
header {
  background: var(--card-bg);
  border-bottom: 1px solid var(--border);
  padding: 16px 24px;
  display: flex;
  align-items: center;
  gap: 16px;
}

/* Fixed header in keyboard mode or with multiple filters */
body.header-fixed header {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  z-index: 100;
}

body.header-fixed main,
body.header-fixed #logsView {
  padding-top: 70px;
}

@media (max-width: 600px) {
  header {
    padding: 12px;
    gap: 8px;
  }
}

.header-left {
  flex: 1;
  min-width: 0;
  display: flex;
  align-items: center;
  gap: 12px;
  overflow: hidden;
  -webkit-mask-image: linear-gradient(to right, black 90%, transparent 100%);
  mask-image: linear-gradient(to right, black 90%, transparent 100%);
}

.header-center {
  flex-shrink: 0;
}

.header-right {
  flex: 1;
  min-width: 0;
  display: flex;
  align-items: center;
  justify-content: flex-end;
  gap: 8px;
  overflow: hidden;
  -webkit-mask-image: linear-gradient(to left, black 90%, transparent 100%);
  mask-image: linear-gradient(to left, black 90%, transparent 100%);
}

header h1 {
  font-size: 20px;
  flex-shrink: 0;
  margin: 0;
}

.btn-icon {
  display: none;
}

@media (max-width: 600px) {
  header h1 {
    display: none;
  }

  .btn-text {
    display: none;
  }

  .btn-icon {
    display: inline;
    font-size: 16px;
  }

  #refreshBtn {
    display: none;
  }

  /* Flatten header on mobile: menu | hostFilter | timeRange | Logs | logout */
  .header-left,
  .header-center,
  .header-right {
    display: contents;
  }

  header {
    display: flex;
    align-items: center;
  }

  #menuBtn { order: 1; }
  #hostFilter { order: 2; flex: 1; min-width: 0; width: auto; }
  #logsBtn { order: 3; }
  #timeRange { order: 4; flex: 1; min-width: 0; width: auto; }
  #logoutBtn { order: 5; }

  /* Hide these on mobile */
  #topN,
  #hostSuggestions {
    display: none;
  }

  /* Position active filters over chart area */
  #activeFilters {
    position: absolute;
    top: 8px;
    right: 12px;
    flex-direction: row-reverse;
    flex-wrap: wrap-reverse;
    justify-content: flex-end;
    z-index: 10;
    max-width: 70%;
    gap: 4px;
  }

  #activeFilters .filter-tag {
    font-size: 11px;
    padding: 2px 6px;
  }

  /* Consistent button height in header */
  header .btn,
  header .logs-btn {
    height: 36px;
    padding: 0 12px;
    display: inline-flex;
    align-items: center;
    justify-content: center;
  }

  /* First button (menu) touches left edge */
  header .menu-btn {
    margin-left: -12px;
    padding-left: 12px;
    padding-right: 10px;
    width: auto;
    border-left: none;
    border-top-left-radius: 0;
    border-bottom-left-radius: 0;
  }

  /* Last button (logout) touches right edge */
  header #logoutBtn {
    margin-right: -12px;
    padding-right: 12px;
    padding-left: 10px;
    border-right: none;
    border-top-right-radius: 0;
    border-bottom-right-radius: 0;
  }
}

.query-timer {
  font-size: 12px;
  font-weight: normal;
  font-family: ui-monospace, SFMono-Regular, "SF Mono", Menlo, Consolas, monospace;
  color: var(--text-secondary);
  margin-left: 8px;
}

.query-timer.fast {
  color: var(--status-ok);
}

.query-timer.medium {
  color: var(--status-client-error);
}

.query-timer.slow {
  color: var(--status-server-error);
}

header select,
header input[type="text"] {
  padding: 8px 12px;
  border: 1px solid var(--border);
  border-radius: 6px;
  font-size: 14px;
  background: var(--input-bg);
  color: var(--text);
}

header input[type="text"] {
  width: 250px;
}

header select option {
  background: var(--card-bg);
  color: var(--text);
}

#activeFilters {
  display: flex;
  gap: 8px;
  flex-shrink: 1;
  min-width: 0;
}

.filter-tag {
  display: inline-flex;
  align-items: center;
  gap: 4px;
  padding: 4px 8px;
  background: var(--filter-tag-bg);
  border: 1px solid var(--filter-tag-border);
  border-radius: 4px;
  font-size: 12px;
  color: var(--filter-tag-color);
  max-width: 200px;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
  flex-shrink: 0;
  cursor: pointer;
}

.filter-tag:hover {
  border-color: var(--primary);
}

.filter-tag.exclude {
  background: var(--bar-bg);
  border-color: var(--error);
  color: var(--error);
}

.filter-tag .filter-color {
  display: inline-block;
  width: 3px;
  height: 12px;
  border-radius: 1px;
  flex-shrink: 0;
}

/* Main Content */
main {
  padding: 0 24px 24px 24px;
}

@media (max-width: 600px) {
  main {
    padding: 0 12px 16px 12px;
  }
}

/* Chart Section */
.chart-section {
  background: var(--chart-bg);
  padding: 20px 0;
  margin: 0 -24px 24px -24px;
  scroll-snap-align: start;
  scroll-margin-top: 0;
}

@media (max-width: 600px) {
  .chart-section {
    margin: 0 -12px 16px -12px;
    position: relative;
  }
}

.chart-container {
  position: relative;
  height: 250px;
}

#chart {
  width: 100%;
  height: 100%;
}

.chart-section h2 {
  display: none;
}

/* Chart navigation overlay */
.chart-nav-overlay {
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  pointer-events: none;
  display: flex;
}

.chart-nav-zone {
  flex: 1;
  display: flex;
  align-items: center;
  justify-content: center;
  pointer-events: auto;
  cursor: pointer;
  opacity: 0;
  transition: opacity 0.2s;
}

.chart-nav-zone:hover {
  opacity: 1;
  background: rgba(0, 0, 0, 0.03);
}

@media (prefers-color-scheme: dark) {
  .chart-nav-zone:hover {
    background: rgba(255, 255, 255, 0.03);
  }
}

.chart-nav-left {
  flex: 0 0 33%;
}

.chart-nav-right {
  flex: 0 0 33%;
  margin-left: auto;
}

.chart-nav-arrow {
  font-size: 48px;
  color: var(--text-secondary);
  opacity: 0.3;
}

.chart-container {
  position: relative;
}

/* Breakdown Tables */
.breakdowns {
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  gap: 16px;
}

.breakdown-card {
  background: var(--card-bg);
  border-radius: 12px;
  padding: 16px;
  border: 1px solid var(--border);
  transition: filter 0.2s ease-out;
  scroll-margin-top: 16px;
  scroll-snap-align: start;
}

@media (max-width: 1400px) {
  .breakdowns {
    grid-template-columns: repeat(3, 1fr);
  }
}

@media (max-width: 1000px) {
  .breakdowns {
    grid-template-columns: repeat(2, 1fr);
  }
}

@media (max-width: 600px) {
  .breakdowns {
    grid-template-columns: 1fr;
    gap: 0;
  }

  /* Remove card chrome on mobile - use horizontal separators instead */
  .breakdown-card {
    background: transparent;
    border: none;
    border-radius: 0;
    padding: 12px 0;
    border-bottom: 1px solid var(--border);
  }

  .breakdown-card:last-child {
    border-bottom: none;
  }

  .breakdown-card h3 {
    margin-bottom: 8px;
  }

  /* Smaller text on mobile */
  .breakdown-table {
    font-size: 12px;
  }

  .breakdown-table .count {
    font-size: 11px;
  }
}

@media (min-width: 1800px) {
  .breakdowns {
    grid-template-columns: repeat(5, 1fr);
  }
}

@media (min-width: 2200px) {
  .breakdowns {
    grid-template-columns: repeat(6, 1fr);
  }
}

@media (min-width: 2600px) {
  .breakdowns {
    grid-template-columns: repeat(7, 1fr);
  }
}

.breakdown-card.updating {
  filter: blur(2px);
  opacity: 0.7;
}

.breakdown-card h3 {
  font-size: 14px;
  font-weight: 600;
  margin-bottom: 12px;
  display: flex;
  align-items: center;
  gap: 8px;
}

.summary-metric {
  margin-left: auto;
  font-size: 12px;
  font-weight: 500;
  color: var(--status-ok);
  background: rgba(18, 183, 106, 0.1);
  padding: 2px 6px;
  border-radius: 4px;
}

.summary-metric.summary-error {
  color: var(--status-server-error);
  background: rgba(240, 68, 56, 0.1);
}

.summary-metric.summary-warning {
  color: var(--status-client-error);
  background: rgba(247, 144, 9, 0.1);
}

@media (prefers-color-scheme: dark) {
  .summary-metric {
    background: rgba(63, 185, 80, 0.15);
  }
  .summary-metric.summary-error {
    background: rgba(248, 81, 73, 0.15);
  }
  .summary-metric.summary-warning {
    background: rgba(210, 153, 34, 0.15);
  }
}

/* Mode toggle button (e.g., Count/Bytes for content-types) */
.mode-toggle {
  margin-left: auto;
  font-size: 11px;
  font-weight: 600;
  color: var(--text-secondary);
  background: linear-gradient(to bottom, var(--bg-primary), var(--bg-secondary));
  border: 1px solid var(--border-color);
  box-shadow: 0 1px 2px rgba(0, 0, 0, 0.05);
  padding: 2px 6px;
  border-radius: 4px;
  cursor: pointer;
  transition: all 0.15s ease;
}

.mode-toggle:hover {
  background: linear-gradient(to bottom, var(--bg-secondary), var(--bg-tertiary));
  border-color: var(--text-secondary);
}

.mode-toggle:active {
  box-shadow: inset 0 1px 2px rgba(0, 0, 0, 0.1);
}

.mode-toggle.active {
  color: var(--accent-color);
  border-color: var(--accent-color);
  background: rgba(99, 102, 241, 0.1);
  box-shadow: none;
}

@media (prefers-color-scheme: dark) {
  .mode-toggle {
    box-shadow: 0 1px 2px rgba(0, 0, 0, 0.2);
  }
  .mode-toggle.active {
    background: rgba(129, 140, 248, 0.15);
  }
}

.speed-indicator {
  width: 8px;
  height: 8px;
  border-radius: 50%;
  flex-shrink: 0;
}

.speed-indicator.fast {
  background: var(--status-ok);
}

.speed-indicator.medium {
  background: var(--status-client-error);
}

.speed-indicator.slow {
  background: var(--status-server-error);
}

.speed-indicator.slowest {
  box-shadow: 0 0 6px 2px currentColor;
}

.speed-indicator.slowest.fast {
  box-shadow: 0 0 6px 2px var(--status-ok);
}

.speed-indicator.slowest.medium {
  box-shadow: 0 0 6px 2px var(--status-client-error);
}

.speed-indicator.slowest.slow {
  box-shadow: 0 0 6px 2px var(--status-server-error);
}

.clear-facet-btn {
  font-size: 11px;
  padding: 2px 6px;
  border-radius: 4px;
  border: 1px solid var(--border);
  background: var(--card-bg);
  color: var(--text-secondary);
  cursor: pointer;
  font-weight: normal;
}

.clear-facet-btn:hover {
  background: var(--bg);
  color: var(--text);
}

.breakdown-table {
  width: 100%;
  font-size: 14px;
}

.breakdown-table tr {
  border-bottom: 1px solid var(--border);
}

.breakdown-table tr:last-child {
  border-bottom: none;
}

.breakdown-table tr.filter-included .dim {
  text-decoration: underline;
  text-decoration-color: var(--text);
  text-underline-offset: 3px;
}

.breakdown-table tr.filter-excluded .dim {
  text-decoration: underline;
  text-decoration-color: var(--error);
  text-underline-offset: 3px;
  opacity: 0.6;
}

.breakdown-table td {
  padding: 2px 0;
}

.breakdown-table .dim {
  max-width: 180px;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}

.breakdown-table .dim .status-color {
  display: inline-block;
  width: 3px;
  height: 12px;
  margin-right: 6px;
  border-radius: 1px;
  vertical-align: middle;
}

.breakdown-table .dim a {
  color: var(--text);
  text-decoration: none;
}

.breakdown-table .dim a:hover {
  color: var(--primary);
  text-decoration: underline;
}

.breakdown-table .dim .dim-prefix {
  opacity: 0.4;
}

.breakdown-table .count {
  text-align: right;
  font-weight: 500;
  white-space: nowrap;
  padding-left: 8px;
  position: relative;
  font-family: 'Source Sans', 'Source Sans Pro', ui-monospace, SFMono-Regular, 'SF Mono', Menlo, Consolas, monospace;
  font-size: 11px;
}

.breakdown-table .count .value {
  display: block;
}

.breakdown-table .count .action-btn {
  display: none;
  position: absolute;
  top: 50%;
  right: 0;
  transform: translateY(-50%);
}

.breakdown-table tr:hover .count .value {
  display: none;
}

.breakdown-table tr:hover .count .action-btn {
  display: block;
}

.breakdown-table .bar {
  width: 60px;
  padding-left: 8px;
  position: relative;
}

.breakdown-table .bar-inner {
  height: 8px;
  background: var(--bar-bg);
  border-radius: 4px;
  overflow: hidden;
  display: flex;
}

.breakdown-table .bar .action-btn {
  display: none;
  position: absolute;
  top: 50%;
  left: 8px;
  transform: translateY(-50%);
}

.breakdown-table tr:hover .bar .bar-inner {
  display: none;
}

.breakdown-table tr:hover .bar .action-btn {
  display: block;
}

.breakdown-table .bar-segment {
  height: 100%;
}

.breakdown-table .bar-5xx {
  background: var(--status-server-error);
}

.breakdown-table .bar-4xx {
  background: var(--status-client-error);
}

.breakdown-table .bar-ok {
  background: var(--status-ok);
}

.breakdown-table .bar-fill {
  height: 100%;
  background: var(--primary);
  border-radius: 4px;
}

.breakdown-table .action-btn {
  padding: 2px 8px;
  font-size: 11px;
  border-radius: 4px;
  border: 1px solid var(--border);
  background: var(--card-bg);
  cursor: pointer;
  color: var(--text);
  white-space: nowrap;
}

.breakdown-table .action-btn:hover {
  background: var(--bg);
}

.breakdown-table .action-btn.exclude {
  color: var(--error);
}

/* Mobile touch support - tap to reveal action buttons */
/* Hide mobile actions by default everywhere */
.breakdown-table .mobile-actions {
  display: none;
}

/* On touch screens, use tap-to-reveal pattern */
@media (hover: none), (pointer: coarse) {
  /* Disable desktop hover behavior */
  .breakdown-table tr:hover .count .value,
  .breakdown-table tr:hover .bar .bar-inner {
    display: block;
  }

  .breakdown-table tr:hover .count .action-btn,
  .breakdown-table tr:hover .bar .action-btn {
    display: none;
  }

  /* When row is tapped (touch-active), show mobile actions and hide bar */
  .breakdown-table tr.touch-active .bar {
    display: none;
  }

  .breakdown-table tr.touch-active .mobile-actions {
    display: table-cell;
    text-align: right;
    white-space: nowrap;
    vertical-align: middle;
  }

  .breakdown-table .mobile-action-btn {
    position: relative;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    width: 18px;
    height: 18px;
    padding: 0;
    font-size: 12px;
    font-weight: 600;
    line-height: 1;
    border-radius: 3px;
    border: 1px solid var(--border);
    background: var(--card-bg);
    cursor: pointer;
    color: var(--text);
    box-sizing: border-box;
    margin-left: 6px;
    vertical-align: middle;
  }

  /* Expanded touch target */
  .breakdown-table .mobile-action-btn::before {
    content: '';
    position: absolute;
    top: -10px;
    left: -10px;
    right: -10px;
    bottom: -10px;
  }

  .breakdown-table .mobile-action-btn:active {
    background: var(--bg);
  }

  .breakdown-table .mobile-action-btn.exclude {
    color: var(--error);
  }

  .breakdown-table .mobile-action-btn.active {
    background: var(--primary);
    color: white;
    border-color: var(--primary);
  }

  .breakdown-table .mobile-action-btn.active.exclude {
    background: var(--error);
    border-color: var(--error);
  }
}

.breakdown-table tr.other-row,
.breakdown-table tr.synthetic-row {
  opacity: 0.7;
}

.breakdown-table tr.other-row {
  cursor: pointer;
}

.breakdown-table tr.other-row:hover,
.breakdown-table tr.synthetic-row:hover {
  opacity: 1;
}

.breakdown-table tr.other-row:hover .bar-inner {
  display: flex;
}

.breakdown-table .bar-inner.bar-overflow {
  -webkit-mask-image: linear-gradient(to right, black 60%, transparent 100%);
  mask-image: linear-gradient(to right, black 60%, transparent 100%);
}

/* Loading */
.loading {
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 40px;
  color: var(--text-secondary);
}

.spinner {
  width: 20px;
  height: 20px;
  border: 2px solid var(--border);
  border-top-color: var(--primary);
  border-radius: 50%;
  animation: spin 0.8s linear infinite;
  margin-right: 8px;
}

@keyframes spin {
  to { transform: rotate(360deg); }
}

/* Empty State */
.empty {
  text-align: center;
  padding: 20px;
  color: var(--text-secondary);
  font-size: 13px;
}

/* Logs Button */
.logs-btn {
  padding: 8px 24px;
  font-size: 14px;
  background: var(--card-bg);
  color: var(--text);
  border: 1px solid var(--border);
  border-radius: 6px;
  cursor: pointer;
  transition: all 0.2s;
}

.logs-btn:hover {
  background: var(--bg);
}

.logs-btn.ready {
  border-color: var(--primary);
}

.logs-btn.active {
  background: var(--bg);
}

/* Logs View */
#logsView {
  display: none;
  padding: 24px;
}

#logsView.visible {
  display: block;
}

#dashboardContent.hidden {
  display: none;
}

.logs-table-container {
  background: var(--card-bg);
  border-radius: 12px;
  border: 1px solid var(--border);
  overflow-x: auto;
  transition: filter 0.2s ease-out;
}

@media (max-width: 600px) {
  #logsView {
    padding: 0;
  }

  .logs-table-container {
    border: none;
    border-radius: 0;
  }
}

.logs-table-container.updating {
  filter: blur(2px);
  opacity: 0.7;
}

.logs-table {
  width: 100%;
  border-collapse: collapse;
  font-size: 12px;
  font-family: 'SF Mono', 'Monaco', 'Inconsolata', 'Roboto Mono', monospace;
}

.logs-table th {
  background: var(--bg);
  padding: 10px 12px;
  text-align: left;
  font-weight: 600;
  border-bottom: 1px solid var(--border);
  position: sticky;
  top: 0;
  white-space: nowrap;
  cursor: pointer;
  user-select: none;
}

.logs-table th:hover {
  background: var(--border);
}

.logs-table th.pinned,
.logs-table td.pinned {
  position: sticky;
  background: var(--card-bg);
  z-index: 1;
}

.logs-table th.pinned {
  z-index: 2;
  background: var(--bg);
}

.logs-table th.pinned::before {
  content: '';
  display: inline-block;
  width: 8px;
  height: 8px;
  border-radius: 50%;
  background: var(--text-secondary);
  margin-right: 6px;
  vertical-align: middle;
}

.logs-table td.pinned {
  border-right: 2px solid var(--border);
}

.logs-table th.pinned:last-of-type,
.logs-table td.pinned:last-of-type {
  border-right: 2px solid var(--primary);
}

.logs-table td {
  padding: 8px 12px;
  border-bottom: 1px solid var(--border);
  vertical-align: top;
  max-width: 300px;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}

.logs-table td.clickable {
  cursor: pointer;
}

.logs-table td.clickable:hover {
  text-decoration: underline;
}

.logs-table tbody tr {
  cursor: copy;
}

.logs-table tr:hover td {
  background: var(--bg);
}

.logs-table tr:last-child td {
  border-bottom: none;
}

.logs-table .status-ok {
  color: var(--status-ok);
}

.logs-table .status-4xx {
  color: var(--status-client-error);
}

.logs-table .status-5xx {
  color: var(--status-server-error);
}

.logs-table .timestamp {
  color: var(--text-secondary);
  white-space: nowrap;
}

.logs-table .log-color {
  display: inline-block;
  width: 3px;
  height: 12px;
  margin-right: 6px;
  border-radius: 1px;
  vertical-align: middle;
}

.logs-table .method {
  font-weight: 600;
}

.logs-table .url {
  max-width: 400px;
}

.logs-table .host {
  max-width: 200px;
}

.logs-loading {
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 60px;
  color: var(--text-secondary);
}

/* Menu Button */
.menu-btn {
  display: flex;
  align-items: center;
  justify-content: center;
  width: 36px;
  height: 36px;
  padding: 0;
  background: var(--card-bg);
  border: 1px solid var(--border);
  border-radius: 8px;
  cursor: pointer;
  color: var(--text);
  transition: all 0.2s;
  flex-shrink: 0;
}

.menu-btn:hover {
  background: var(--bg);
  border-color: var(--primary);
  color: var(--primary);
}

/* Quick Links Modal */
#quickLinksModal {
  padding: 0;
  border: none;
  border-radius: 0;
  background: var(--card-bg);
  box-shadow: 4px 0 24px rgba(0, 0, 0, 0.15);
  width: 400px;
  max-width: 90vw;
  height: 100vh;
  max-height: 100vh;
  margin: 0;
  margin-right: auto;
  position: fixed;
  top: 0;
  left: 0;
  bottom: 0;
}

@media (max-width: 600px) {
  #quickLinksModal {
    width: 100vw;
    max-width: 100vw;
  }
}

#quickLinksModal::backdrop {
  background: rgba(0, 0, 0, 0.5);
  backdrop-filter: blur(4px);
}

.modal-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 16px 20px;
  border-bottom: 1px solid var(--border);
  background: var(--bg);
}

.modal-header h2 {
  font-size: 18px;
  margin: 0;
}

.modal-close {
  display: flex;
  align-items: center;
  justify-content: center;
  width: 32px;
  height: 32px;
  padding: 0;
  background: none;
  border: none;
  border-radius: 6px;
  cursor: pointer;
  color: var(--text-secondary);
  font-size: 24px;
  line-height: 1;
  transition: all 0.2s;
}

.modal-close:hover {
  background: var(--border);
  color: var(--text);
}

#quickLinksFrame {
  width: 100%;
  height: calc(100vh - 57px);
  border: none;
  background: var(--bg);
}

/* ========================================
   Keyboard Navigation Mode
   ======================================== */

/* Keyboard hint elements - hidden by default */
.kbd-hint {
  display: none;
}

/* Show hints when keyboard mode is active */
body.keyboard-mode .kbd-hint {
  display: inline;
}

/* Keyboard control wrapper for toolbar items */
.kbd-control {
  display: inline-flex;
  align-items: center;
  gap: 4px;
}

/* Toolbar kbd hints: use opacity to avoid layout shift */
.kbd-control > kbd.kbd-hint {
  display: inline;
  opacity: 0;
  transition: opacity 0.15s ease;
  font-family: ui-monospace, SFMono-Regular, 'SF Mono', Menlo, Consolas, monospace;
  font-size: 10px;
  padding: 1px 4px;
  margin-right: -13px;
  background: var(--card-bg);
  border: 1px solid var(--border);
  border-radius: 3px;
  box-shadow: 0 1px 2px rgba(0, 0, 0, 0.15);
  color: var(--text-secondary);
  white-space: nowrap;
  z-index: 1;
}

body.keyboard-mode .kbd-control > kbd.kbd-hint {
  opacity: 1;
}

/* Focused facet card gets a blue glow */
body.keyboard-mode .breakdown-card.kbd-focused {
  box-shadow: 0 0 0 1px rgba(59, 130, 246, 0.3), 0 0 16px rgba(59, 130, 246, 0.2);
}

@media (prefers-color-scheme: dark) {
  body.keyboard-mode .breakdown-card.kbd-focused {
    box-shadow: 0 0 0 1px rgba(96, 165, 250, 0.4), 0 0 20px rgba(96, 165, 250, 0.25);
  }
}

/* Focused row - show as hovered (with filter/exclude buttons visible) */
body.keyboard-mode .breakdown-table tr.kbd-focused td.dim {
  background: var(--bg);
}

/* Show action buttons on focused row (same as hover) */
body.keyboard-mode .breakdown-table tr.kbd-focused .count .value {
  display: none;
}

body.keyboard-mode .breakdown-table tr.kbd-focused .count .action-btn {
  display: block;
}

body.keyboard-mode .breakdown-table tr.kbd-focused .bar .bar-inner {
  display: none;
}

body.keyboard-mode .breakdown-table tr.kbd-focused .bar .action-btn {
  display: block;
}

/* Adjacent row hints for h/l navigation - positioned in left margin */
body.keyboard-mode .breakdown-table {
  position: relative;
}

body.keyboard-mode .breakdown-table tr.kbd-prev td.dim::before,
body.keyboard-mode .breakdown-table tr.kbd-next td.dim::before {
  position: absolute;
  left: -22px;
  margin-top: 2px;
  font-family: ui-monospace, SFMono-Regular, 'SF Mono', Menlo, Consolas, monospace;
  font-size: 10px;
  padding: 1px 4px;
  background: var(--bg);
  border: 1px solid var(--border);
  border-radius: 3px;
  box-shadow: 0 1px 2px rgba(0, 0, 0, 0.15);
  color: var(--text-secondary);
}

body.keyboard-mode .breakdown-table tr.kbd-prev td.dim::before {
  content: 'h';
}

body.keyboard-mode .breakdown-table tr.kbd-next td.dim::before {
  content: 'l';
}

/* Adjacent facet hints for j/k navigation */
body.keyboard-mode .breakdown-card.kbd-prev-facet,
body.keyboard-mode .breakdown-card.kbd-next-facet {
  position: relative;
}

body.keyboard-mode .breakdown-card.kbd-prev-facet > h3::before,
body.keyboard-mode .breakdown-card.kbd-next-facet > h3::before {
  position: absolute;
  left: -6px;
  top: 16px;
  font-family: ui-monospace, SFMono-Regular, 'SF Mono', Menlo, Consolas, monospace;
  font-size: 10px;
  font-weight: normal;
  padding: 1px 4px;
  background: var(--bg);
  border: 1px solid var(--border);
  border-radius: 3px;
  box-shadow: 0 1px 2px rgba(0, 0, 0, 0.15);
  color: var(--text-secondary);
}

body.keyboard-mode .breakdown-card.kbd-prev-facet > h3::before {
  content: 'k';
}

body.keyboard-mode .breakdown-card.kbd-next-facet > h3::before {
  content: 'j';
}

/* (other) row shows ... hint in keyboard mode */
body.keyboard-mode .other-row td.dim .dim-prefix::after {
  content: '...';
}

/* Keyboard help dialog */
#keyboardHelp {
  padding: 0;
  border: 1px solid var(--border);
  border-radius: 12px;
  background: var(--card-bg);
  color: var(--text);
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
  max-width: 500px;
  width: 90vw;
  position: fixed;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  margin: 0;
}

#keyboardHelp::backdrop {
  background: rgba(0, 0, 0, 0.5);
  backdrop-filter: blur(4px);
}

.keyboard-help-content {
  padding: 20px;
}

.keyboard-help-content h2 {
  margin: 0 0 16px 0;
  font-size: 18px;
  display: flex;
  align-items: center;
  justify-content: space-between;
}

.keyboard-help-content h2 button {
  background: none;
  border: none;
  font-size: 24px;
  cursor: pointer;
  color: var(--text-secondary);
  padding: 0;
  line-height: 1;
}

.keyboard-help-content h2 button:hover {
  color: var(--text);
}

.keyboard-help-grid {
  display: grid;
  grid-template-columns: auto 1fr;
  gap: 8px 16px;
  font-size: 14px;
}

.keyboard-help-grid kbd {
  font-family: ui-monospace, SFMono-Regular, 'SF Mono', Menlo, Consolas, monospace;
  background: var(--bg);
  border: 1px solid var(--border);
  border-radius: 4px;
  padding: 2px 6px;
  font-size: 12px;
  white-space: nowrap;
}

.keyboard-help-grid .key-group {
  display: flex;
  gap: 4px;
  align-items: center;
}

.keyboard-help-grid .key-desc {
  color: var(--text-secondary);
}

/* Focus styles for accessibility - no visible outline, background handles it */
.breakdown-table tr:focus {
  outline: none;
}

.breakdown-table tr:focus-visible {
  outline: none;
}

/* Hide keyboard mode on mobile/touch devices */
@media (hover: none), (pointer: coarse) {
  body.keyboard-mode .kbd-hint {
    display: none !important;
  }

  body.keyboard-mode .kbd-control > kbd.kbd-hint {
    opacity: 0 !important;
  }

  body.keyboard-mode .breakdown-card.kbd-focused {
    box-shadow: none;
  }

  body.keyboard-mode .breakdown-table tr.kbd-focused td {
    background: transparent;
  }

  body.keyboard-mode .breakdown-table tr.kbd-prev td.dim::before,
  body.keyboard-mode .breakdown-table tr.kbd-next td.dim::before,
  body.keyboard-mode .breakdown-card.kbd-prev-facet h3::before,
  body.keyboard-mode .breakdown-card.kbd-next-facet h3::before {
    display: none;
  }
}
