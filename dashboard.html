<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>CDN Analytics</title>
  <link rel="stylesheet" href="dashboard.css">
</head>
<body>
  <!-- Login Form -->
  <div id="login">
    <div class="login-card">
      <h1>CDN Analytics</h1>
      <p>Sign in to view your analytics dashboard</p>
      <div id="loginError" class="error-message"></div>
      <form id="loginForm">
        <div class="form-group">
          <label for="username">Username</label>
          <input type="text" id="username" name="username" required autocomplete="username">
        </div>
        <div class="form-group">
          <label for="password">Password</label>
          <input type="password" id="password" name="password" required autocomplete="current-password">
        </div>
        <button type="submit" class="btn btn-primary">Sign In</button>
      </form>
    </div>
  </div>

  <!-- Dashboard -->
  <div id="dashboard">
    <header>
      <div class="header-left">
        <h1>CDN Analytics <span id="queryTimer" class="query-timer"></span></h1>
        <div id="activeFilters"></div>
      </div>
      <div class="header-center">
        <button id="logsBtn" class="logs-btn">Logs</button>
      </div>
      <div class="header-right">
        <select id="timeRange">
          <option value="15m">Last 15 minutes</option>
          <option value="1h" selected>Last hour</option>
          <option value="12h">Last 12 hours</option>
          <option value="24h">Last 24 hours</option>
          <option value="7d">Last 7 days</option>
        </select>
        <select id="topN">
          <option value="5" selected>Top 5</option>
          <option value="10">Top 10</option>
          <option value="20">Top 20</option>
          <option value="50">Top 50</option>
          <option value="100">Top 100</option>
        </select>
        <input type="text" id="hostFilter" placeholder="Filter by host..." list="hostSuggestions" autocomplete="off">
        <datalist id="hostSuggestions"></datalist>
        <button id="refreshBtn" class="btn btn-secondary">Refresh</button>
        <button id="logoutBtn" class="btn btn-secondary">Logout</button>
      </div>
    </header>

    <!-- Logs View -->
    <div id="logsView">
      <div class="logs-table-container">
        <div class="logs-loading"><div class="spinner"></div>Loading logs...</div>
      </div>
    </div>

    <main id="dashboardContent">
      <!-- Time Series Chart -->
      <section class="chart-section">
        <h2>Requests over time</h2>
        <div class="chart-container">
          <canvas id="chart"></canvas>
        </div>
      </section>

      <!-- Breakdown Tables -->
      <section class="breakdowns" id="breakdowns">
        <div class="breakdown-card" id="breakdown-status-range">
          <h3>Status Range</h3>
          <div class="loading"><div class="spinner"></div>Loading...</div>
        </div>
        <div class="breakdown-card" id="breakdown-hosts">
          <h3>Hosts</h3>
          <div class="loading"><div class="spinner"></div>Loading...</div>
        </div>
        <div class="breakdown-card" id="breakdown-forwarded-hosts">
          <h3>Forwarded Hosts</h3>
          <div class="loading"><div class="spinner"></div>Loading...</div>
        </div>
        <div class="breakdown-card" id="breakdown-content-types">
          <h3>Content Types</h3>
          <div class="loading"><div class="spinner"></div>Loading...</div>
        </div>
        <div class="breakdown-card" id="breakdown-status">
          <h3>Status Codes</h3>
          <div class="loading"><div class="spinner"></div>Loading...</div>
        </div>
        <div class="breakdown-card" id="breakdown-errors">
          <h3>Errors</h3>
          <div class="loading"><div class="spinner"></div>Loading...</div>
        </div>
        <div class="breakdown-card" id="breakdown-cache">
          <h3>Cache Status</h3>
          <div class="loading"><div class="spinner"></div>Loading...</div>
        </div>
        <div class="breakdown-card" id="breakdown-paths">
          <h3>Paths</h3>
          <div class="loading"><div class="spinner"></div>Loading...</div>
        </div>
        <div class="breakdown-card" id="breakdown-referers">
          <h3>Referers</h3>
          <div class="loading"><div class="spinner"></div>Loading...</div>
        </div>
        <div class="breakdown-card" id="breakdown-user-agents">
          <h3>User Agents</h3>
          <div class="loading"><div class="spinner"></div>Loading...</div>
        </div>
        <div class="breakdown-card" id="breakdown-ips">
          <h3>IP Addresses</h3>
          <div class="loading"><div class="spinner"></div>Loading...</div>
        </div>
        <div class="breakdown-card" id="breakdown-request-type">
          <h3>Request Types</h3>
          <div class="loading"><div class="spinner"></div>Loading...</div>
        </div>
        <div class="breakdown-card" id="breakdown-backend-type">
          <h3>Backend Types</h3>
          <div class="loading"><div class="spinner"></div>Loading...</div>
        </div>
        <div class="breakdown-card" id="breakdown-methods">
          <h3>HTTP Methods</h3>
          <div class="loading"><div class="spinner"></div>Loading...</div>
        </div>
        <div class="breakdown-card" id="breakdown-datacenters">
          <h3>Datacenters</h3>
          <div class="loading"><div class="spinner"></div>Loading...</div>
        </div>
        <div class="breakdown-card" id="breakdown-asn">
          <h3>ASN</h3>
          <div class="loading"><div class="spinner"></div>Loading...</div>
        </div>
      </section>
    </main>
  </div>

  <script src="dashboard.js"></script>
</body>
</html>
